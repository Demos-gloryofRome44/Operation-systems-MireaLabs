# Лабораторная работа №8: Многопоточное программирование с синхронизацией мьютексами

## Цель работы
Изучение принципов многопоточного программирования и синхронизации доступа к общим ресурсам с использованием мьютексов POSIX (pthread mutex). Практическое освоение создания и управления потоками, а также защиты общих данных от состояния гонки (race condition).

## Описание задачи
Разработать многопоточное приложение, которое создает:
- **1 пишущий поток** - записывает данные в общий массив
- **10 читающих потоков** - читают данные из общего массива

Все потоки работают с одним и тем же разделяемым массивом символов. Доступ к массиву должен быть синхронизирован с использованием мьютекса pthread для предотвращения конфликтов при одновременном обращении.

### Архитектура программы

#### 1. **Разделяемые данные** (глобальные переменные):
```c
char shared_array[ARRAY_SIZE];     // Общий массив символов
pthread_mutex_t mutex;             // Мьютекс для синхронизации
int write_counter = 0;             // Счетчик записей
```

#### 2. **Пишущий поток** (`writer_thread`):
- Захватывает мьютекс перед доступом к массиву
- Увеличивает счетчик записей на 1
- Форматирует строку с номером записи и записывает в массив
- Выводит информацию о выполненной записи
- Освобождает мьютекс
- Ждет 2 секунды перед следующей записью
- Работает в бесконечном цикле

#### 3. **Читающий поток** (`reader_thread`):
- Принимает в качестве параметра свой идентификатор
- Захватывает мьютекс перед доступом к массиву
- Читает текущее содержимое массива
- Выводит свой TID и прочитанные данные
- Освобождает мьютекс
- Ждет 1 секунду перед следующим чтением
- Работает в бесконечном цикле

#### 4. **Основной поток** (`main`):
- Инициализирует мьютекс
- Создает пишущий поток
- Создает 10 читающих потоков
- Ожидает 10 секунд работы программы
- Корректно завершает все потоки
- Освобождает ресурсы (уничтожает мьютекс)

### Механизм синхронизации

while((a < b)) { ... }

Используется **мьютекс POSIX** для обеспечения взаимоисключающего доступа к общему массиву:

```c
// Захват мьютекса (блокировка)
pthread_mutex_lock(&mutex);

// Критическая секция - работа с общими данными
// ...

// Освобождение мьютекса (разблокировка)
pthread_mutex_unlock(&mutex);
```

**Принцип работы:**
1. Когда один поток захватывает мьютекс, другие потоки, пытающиеся захватить тот же мьютекс, блокируются
2. После освобождения мьютекса один из ожидающих потоков получает доступ
3. Гарантируется, что только один поток в каждый момент времени работает с общим массивом

## Инструкция по сборке и запуску

### Сборка программы:

```bash
# Очистка предыдущих сборок (если есть)
make clean

# Сборка программы
make

### Запуск программы:

```bash
./main
```

### Автоматическая сборка и запуск:

```bash
make run
```